<!doctype html>
<html>
  <head>
    <title>Logger Management</title>
    <script>
      function sendPutRequest(form, path) {
        var data = {};
        data.regexp = form.regexp.value;
        data.level =  form.level.value;
        var dataJson = JSON.stringify(data);
        url = document.URL.concat(path);
        xmlHttp = new XMLHttpRequest();
        xmlHttp.open('PUT', url, true);
        xmlHttp.setRequestHeader('Content-type','application/json; charset=utf-8');
        xmlHttp.onreadystatechange = function() {
          document.location.reload(true);
        }
        xmlHttp.send(dataJson);
        return false;
      }
    </script>
  </head>
  <body>
    <fieldset>
      <legend>Information about all loggers</legend>
      <dl>
        {{range $k, $v := .LoggersInfo}}
        <dt><a href="/tail/{{$k}}">{{$k}}</a></dt>
        <dd>- {{$v}}</dd>
        {{end}}
      </dl>
    </fieldset>

    <form onsubmit="return sendPutRequest(this, 'regexp')" name="change_level">
      <fieldset>
        <legend>Change level through regular expression here</legend>
        regexp: <input type="text" name="regexp"/>
        level:
        <select name="level">
          {{range .Levels}}
          <option value="{{.}}">{{.}}</option>
          {{end}}
        </select><br/>
        <input type="submit" value="Change"/>
      </fieldset>
    </form>
  </body>
</html>
